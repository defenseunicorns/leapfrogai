apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ .Values.nameOverride }}-sdk-configmap"
  namespace: {{ .Release.Namespace | default "leapfrogai" }}
data:
  config.yaml: |
    model:
      source: {{ .Values.leapfrogaiConfig.model.source }}
    max_context_length: {{ .Values.leapfrogaiConfig.maxContextLength }}
    stop_tokens:
    {{- $stopTokens := .Values.leapfrogaiConfig.stopTokens }}
    {{- range $stopToken := splitList ", " .Values.leapfrogaiConfig.stopTokens }}
    - {{ printf "%s" $stopToken }}
    {{- end }}
    prompt_format:
    {{- with .Values.leapfrogaiConfig.promptFormat.chat }}
      chat:
      {{- if .system }}
        system: {{ .system }}
      {{- end }}
      {{- if .assistant }}
        assistant: {{ .assistant }}
      {{- end }}
      {{- if .user }}
        user: {{ .user }}
      {{- end }}
      {{- if .function }}
        function: {{ .function }}
      {{- end }}
    {{- end }}
    defaults:
      temperature: {{ .Values.leapfrogaiConfig.defaults.temperature }}
      top_p: {{ .Values.leapfrogaiConfig.defaults.topP }}
      top_k: {{ .Values.leapfrogaiConfig.defaults.topK }}
      repetition_penalty: {{ .Values.leapfrogaiConfig.defaults.repetitionPenalty }}
      max_new_tokens: {{ .Values.leapfrogaiConfig.defaults.maxNewTokens }}
